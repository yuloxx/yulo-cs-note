{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Welcome to yulo-cs-note","text":""},{"location":"#aim","title":"Aim","text":"<p>yulo-cs-note is a collection of practical computer science knowledge. This site aims to provide quick guide, useful experiences for various computer technologies.</p>"},{"location":"#content","title":"Content","text":"<ul> <li>computer science</li> <li>program languages</li> <li>database</li> <li>cloud services</li> <li>useful tools</li> <li>ML &amp;&amp; AI</li> </ul>"},{"location":"#repository","title":"Repository","text":"<p>You can explore the full source and contribute on GitHub:   yuloxx/yulo-cs-note</p>"},{"location":"big-data/zookeeper/","title":"ZooKeeper","text":""},{"location":"big-data/zookeeper/#what-is-zookeeper","title":"What is ZooKeeper?","text":"<p>ZooKeeper is a reliable distributed coordination service that helps nodes maintain consistent configurations, metadata, and state information.</p> <p>Key Functions:</p> <ul> <li>Configuration Management</li> <li>Metadata Storage</li> <li>Event Listeners</li> <li>Leader Election</li> </ul>"},{"location":"big-data/zookeeper/#quick-start","title":"Quick Start","text":"<p>Prerequisites: a Linux machine with JDK installed</p> <p>Download Page: Apache ZooKeeper</p> <p>First, start a standalone ZooKeeper service:</p> <pre><code>tar -xzvf apache-zookeeper-x.y.z-bin.tar.gz\n\n# Enter the root directory\ncd apache-zookeeper-x.y.z-bin\n\n# Create a config file\n# Default configuration: \n# tickTime=2000\n# dataDir=/tmp/zookeeper\n# clientPort=2181\ncp conf/zoo_sample.cfg conf/zoo.cfg\n\n# Start Server\n# If success, we will see:\n# ZooKeeper JMX enabled by default\n# Using config: zookeeper-path/bin/../conf/zoo.cfg\n# Starting zookeeper ... STARTED\nbin/zkServer.sh start\n\n# Check server status\n# If server works well, we will see:\n# Using config: zookeeper-path/bin/../conf/zoo.cfg\n# Client port found: 2181. Client address: localhost. Client SSL: false.\n# Mode: standalone\nbin/zkServer.sh status\n\n\n# Stop server\n# \nbin/zkServer.sh stop\n</code></pre> <p>Next, perform basic data operations (persistent node):</p> <pre><code># show znodes of a path\nls /\n\n# create a znode\ncreate /node1 \"hello\"\n\n# read node data\nget /node1\n\n# set node data\nset /node1 \"hello,zk\"\n\n# delete node data \ndeleteall /node1\n</code></pre>"},{"location":"big-data/zookeeper/#znode","title":"ZNode","text":"<p>ZooKeeper maintains a tree-like directory structure similar to a file system.</p> <p>Example:</p> <pre><code>/\n\u251c\u2500\u2500 app\n\u2502   \u251c\u2500\u2500 config\n\u2502   \u251c\u2500\u2500 leader\n\u2502   \u2514\u2500\u2500 workers\n\u2514\u2500\u2500 locks\n</code></pre> <p>Znode Data:</p> <ul> <li>Byte array data (maximum 1MB)</li> <li>Child nodes (excluding ephemeral nodes)</li> <li>Statistical data (version, timestamp)</li> </ul> <p>Znode Types:</p> <p>Persistent Znode: Remains intact after restarts or session expiration, suitable for configuration storage.</p> <pre><code>create /app/config \"db=localhost\"\n</code></pre> <p>Ephemeral Znode: Automatically deleted when the session ends (cannot have child nodes), ideal for service registration, heartbeats, and online status.</p> <pre><code>create -e /workers/worker-A \"10.0.0.1\"\n</code></pre> <p>Persistent Sequential Znode: Used for distributed locks.</p> <pre><code>create -s /queue/job \"task1\"\n</code></pre> <p>Result:</p> <pre><code>/queue\n  \u2514\u2500\u2500 job0000000001   (Persistent Sequential)\n</code></pre> <p>Ephemeral Sequential Znode: Used for distributed locks or leader election.</p> <pre><code>create -e -s /lock/node \"A\"\n</code></pre> <p>When multiple clients create ephemeral sequential znodes under the same path, the client with the smallest sequence number acquires the lock or wins the election.</p>"},{"location":"big-data/zookeeper/#watcher","title":"Watcher","text":"<p>Watchers provide a lightweight mechanism for notifying data changes. Supported events include:</p> <ul> <li>Child znode changes</li> <li>Znode data modifications</li> <li>Znode deletion</li> </ul> <p>Demonstration:</p> <p>Open a connection using zkCli.sh in session S1:</p> <pre><code>zkCli.sh -server localhost:2181\ncreate /watch_example \"initial_data\"\n</code></pre> <p>Open another connection using zkCli.sh in session S2:</p> <pre><code>zkCli.sh -server localhost:2181\nget -w /watch_example\n</code></pre> <p>Update the data in session S1:</p> <pre><code>set /watch_example \"updated_data\"\n</code></pre> <p>Output in S2:</p> <pre><code>[zk: localhost:2181(CONNECTED) 0] get -w /watch_example\ninitial_data\n[zk: localhost:2181(CONNECTED) 1]\nWATCHER::\n\nWatchedEvent state:SyncConnected type:NodeDataChanged path:/watch_example zxid: 4\n</code></pre> <p>Note: Watchers are one-time triggers. After being triggered, subsequent events will not be notified. To continue monitoring a znode, you must re-register the watcher.</p>"},{"location":"big-data/zookeeper/#leader-election","title":"Leader Election","text":"<p>ZooKeeper offers a reliable and straightforward method for leader election: create ephemeral sequential nodes and elect the instance with the smallest sequence number.</p> <p>Each application instance attempts to create a sequential znode under the election directory. The instance with the smallest sequence number becomes the leader.</p> <pre><code>/myapp/leader/instance-0000000001\n/myapp/leader/instance-0000000002\n/myapp/leader/instance-0000000003\n...\n</code></pre> <p>Each instance monitors the election directory. If the leader fails, its sequential znode is removed, triggering a new election.</p>"},{"location":"big-data/zookeeper/#example-project","title":"Example Project","text":"<p>This project demonstrates how to start a leader election thread and coordinate with business threads through a global state service. Package the project with Maven and run the JAR to observe the leader election process!</p> <pre><code>+---main\n|   +---java\n|   |   \\---org\n|   |       \\---example\n|   |               Application.java\n|   |               CuratorConfig.java\n|   |               LeaderController.java\n|   |               LeaderElectionService.java\n|   |               LeaderStateService.java\n|   |\n|   \\---resources\n|           application.yml\n|\npom.xml\n</code></pre> <p>pom.xml:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\"\n         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\n    &lt;groupId&gt;org.example&lt;/groupId&gt;\n    &lt;artifactId&gt;my-spring&lt;/artifactId&gt;\n    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;\n\n    &lt;properties&gt;\n        &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt;\n        &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt;\n        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n        &lt;spring-boot.version&gt;2.7.6&lt;/spring-boot.version&gt;\n    &lt;/properties&gt;\n\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;\n            &lt;artifactId&gt;curator-framework&lt;/artifactId&gt;\n            &lt;version&gt;4.3.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.curator&lt;/groupId&gt;\n            &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt;\n            &lt;version&gt;4.3.0&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt;\n            &lt;artifactId&gt;zookeeper&lt;/artifactId&gt;\n            &lt;version&gt;3.6.3&lt;/version&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n\n    &lt;dependencyManagement&gt;\n        &lt;dependencies&gt;\n            &lt;dependency&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;\n                &lt;version&gt;${spring-boot.version}&lt;/version&gt;\n                &lt;type&gt;pom&lt;/type&gt;\n                &lt;scope&gt;import&lt;/scope&gt;\n            &lt;/dependency&gt;\n        &lt;/dependencies&gt;\n    &lt;/dependencyManagement&gt;\n\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${spring-boot.version}&lt;/version&gt;\n                &lt;executions&gt;\n                    &lt;execution&gt;\n                        &lt;goals&gt;\n                            &lt;goal&gt;repackage&lt;/goal&gt;\n                        &lt;/goals&gt;\n                    &lt;/execution&gt;\n                &lt;/executions&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre> <p>application.yml:</p> <pre><code>zookeeper:\n  connect-string: \"a.b.c.d:xxxx\"\n</code></pre> <p>Application.java:</p> <pre><code>package org.example;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class Application {\n\n    public static void main(String[] args) {\n        SpringApplication.run(Application.class, args);\n    }\n}\n</code></pre> <p>CuratorConfig.java:</p> <pre><code>package org.example;\n\nimport org.apache.curator.framework.CuratorFramework;\nimport org.apache.curator.framework.CuratorFrameworkFactory;\nimport org.apache.curator.retry.ExponentialBackoffRetry;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\npublic class CuratorConfig {\n\n    @Value(\"${zookeeper.connect-string}\")\n    private String connectString;\n\n    @Bean(initMethod = \"start\")\n    public CuratorFramework curatorFramework() {\n        return CuratorFrameworkFactory.builder()\n                .connectString(connectString)\n                .sessionTimeoutMs(60000)\n                .connectionTimeoutMs(15000)\n                .retryPolicy(new ExponentialBackoffRetry(1000, 3))\n                .build();\n    }\n\n}\n</code></pre> <p>LeaderElectionService.java:</p> <pre><code>package org.example;\n\nimport org.apache.curator.framework.CuratorFramework;\nimport org.apache.curator.framework.recipes.leader.LeaderSelector;\nimport org.apache.curator.framework.recipes.leader.LeaderSelectorListenerAdapter;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.stereotype.Service;\n\nimport javax.annotation.PostConstruct;\nimport javax.annotation.PreDestroy;\nimport javax.annotation.Resource;\n\n@Service\npublic class LeaderElectionService {\n\n    private static final String LEADER_PATH = \"/demo-app/leader_election\";\n\n    private static final Logger log = LoggerFactory.getLogger(LeaderElectionService.class);\n\n    @Resource\n    private CuratorFramework client;\n\n    @Resource\n    private LeaderStateService leaderStateService;\n\n    private LeaderSelector leaderSelector;\n\n    @PostConstruct\n    public void start() {\n        leaderSelector = new LeaderSelector(client, LEADER_PATH, new LeaderSelectorListenerAdapter() {\n\n            @Override\n            public void takeLeadership(CuratorFramework curatorFramework) throws Exception {\n                log.info(\"I'm leader now\");\n                leaderStateService.setLeader(true);\n\n                try {\n                    Thread.sleep(Long.MAX_VALUE);\n                } finally {\n                    leaderStateService.setLeader(false);\n                    log.info(\"I am no longer Leader.\");\n                }\n            }\n        });\n        leaderSelector.autoRequeue();\n        leaderSelector.start();\n        log.info(\"Leader election started.\");\n    }\n\n    @PreDestroy\n    public void stop() {\n        if (leaderSelector != null) {\n            leaderSelector.close();\n        }\n    }\n\n}\n</code></pre> <p>LeaderStateService.java:</p> <pre><code>package org.example;\n\nimport org.springframework.stereotype.Component;\n\nimport java.util.concurrent.atomic.AtomicBoolean;\n\n@Component\npublic class LeaderStateService {\n    private final AtomicBoolean isLeader = new AtomicBoolean(false);\n\n    public boolean isLeader() {\n        return isLeader.get();\n    }\n\n    public void setLeader(boolean leader) {\n        isLeader.set(leader);\n    }\n}\n</code></pre> <p>LeaderController.java:</p> <pre><code>package org.example;\n\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport javax.annotation.Resource;\n\n@RestController\npublic class LeaderController {\n\n    @Resource\n    private LeaderStateService leaderStateService;\n\n    @GetMapping(\"/isLeader\")\n    public String isLeader() {\n        return leaderStateService.isLeader() ? \"YES, I am leader\" : \"NO, I am follower\";\n    }\n}\n</code></pre>"},{"location":"cloud-service/elasticsearch/","title":"Elasticsearch","text":""},{"location":"cloud-service/elasticsearch/#what-is-elasticsearch","title":"What is Elasticsearch","text":"<p>Elasticsearch is a open-source search and analytics engine. It can quickly search through massive amounts of text data.  Its primary strength is finding relevant documents based on complex queries.</p>"},{"location":"cloud-service/elasticsearch/#concept","title":"Concept","text":"<ul> <li>Document: A json object contains business data(product description, log message, blog, ...)</li> <li> <p>Index: A collection of documents that have similar characteristics. Similar to \"table\" in RDBMS.</p> </li> <li> <p>Shard: Elasticsearch subdivides an index into multiple pieces called shards.</p> </li> </ul>"},{"location":"cloud-service/elasticsearch/#quick-start","title":"Quick Start","text":"<p>Prerequisites: a Linux machine with JDK installed</p> <p>Download Page: Download Elasticsearch | Elastic</p> <p>First, start a standalone Elasticsearch service:</p> <pre><code>tar -xzvf elasticsearch-7.16.0-linux-x86_64.tar.gz\ncd elasticsearch-7.16.0\n\n# Optional\nvim config/elasticsearch.yml\n\n# start background\nnohup bin/elasticsearch &gt; elasticsearch.log 2&gt;&amp;1 &amp;\n</code></pre> <p>Install Kibana(Optional)</p> <p>Kibana Functions:</p> <ul> <li>Data Visualization</li> <li>Dev Tools (Console Query)</li> <li>Elasticsearch Management</li> </ul> <pre><code>tar -xzvf kibana-7.16.0-linux-x86_64.tar.gz\ncd kibana-7.16.0-linux-x86_64\n\n# server.host: \"0.0.0.0\"\n# elasticsearch.hosts: [\"http://localhost:9200\"]\nvim config/kibana.yml\n\n# Run kibana background\nnohup bin/kibana &gt; kibana.log 2&gt;&amp;1 &amp;\n</code></pre> <p>Test Connection:</p> <p>GET /</p> <p>Response: </p> <pre><code>{\n    \"name\": \"ubuntu\",\n    \"cluster_name\": \"elasticsearch\",\n    \"cluster_uuid\": \"ZYjaWGqATmWXA4ndLUv5Zg\",\n    \"version\": {\n        \"number\": \"7.16.0\",\n        \"build_flavor\": \"default\",\n        \"build_type\": \"tar\",\n        \"build_hash\": \"6fc81662312141fe7691d7c1c91b8658ac17aa0d\",\n        \"build_date\": \"2021-12-02T15:46:35.697268109Z\",\n        \"build_snapshot\": false,\n        \"lucene_version\": \"8.10.1\",\n        \"minimum_wire_compatibility_version\": \"6.8.0\",\n        \"minimum_index_compatibility_version\": \"6.0.0-beta1\"\n    },\n    \"tagline\": \"You Know, for Search\"\n}\n</code></pre>"},{"location":"cloud-service/elasticsearch/#index-document-apis","title":"Index &amp; Document APIs","text":"<p>Create Index:</p> <p>PUT /{indexName}</p> <p>Request: </p> <pre><code>{\n  \"settings\": {\n    \"number_of_shards\": 1,\n    \"number_of_replicas\": 0\n  },\n  \"mappings\": {\n    \"properties\": {\n      \"title\": {\n        \"type\": \"text\"\n      },\n      \"created_at\": {\n        \"type\": \"date\"\n      },\n      \"views\": {\n        \"type\": \"integer\"\n      }\n    }\n  }\n}\n</code></pre> <p>Delete Index:</p> <p>DELETE /{indexName}</p> <p>Create Doc: </p> <p>POST /{indexName}/_doc</p> <p>Request:</p> <pre><code>{\n  \"title\": \"Elasticsearch Tutorial\",\n  \"content\": \"This is a tutorial about Elasticsearch\",\n  \"tags\": [\"search\", \"database\"],\n  \"created_at\": \"2024-01-01\",\n  \"views\": 100\n}\n</code></pre> <p>Get Doc:</p> <p>GET /{indexName}/_doc/{id}</p>"},{"location":"cloud-service/elasticsearch/#search-api","title":"Search API","text":"<p>GET /{indexName}/_search</p> <p>Support Operation:</p> <p>match </p> <p>go through tokenizer for text, not for keyword/number/date.</p> <pre><code>GET INDEX_NAME/_search\n{\n  \"query\": {\n    \"match\": {\n      \"FIELD_NAME\": \"apple\"\n    }\n  }\n}\n</code></pre> <p>term</p> <p>suitable for non-tokenized keyword field or number field.</p> <pre><code>GET INDEX_NAME/_search\n{\n  \"query\": {\n    \"term\": {\n      \"FIELD_NAME\": \"success\"\n    }\n  }\n}\n</code></pre> <p>range</p> <pre><code>GET INDEX_NAME/_search\n{\n  \"query\": {\n    \"range\": {\n      \"FIELD_NAME\": {\n        \"gte\": 100,\n        \"lte\": 500\n      }\n    }\n  }\n}\n</code></pre> <p>bool</p> <ul> <li>must</li> <li>should (effect score)</li> <li>must_not</li> <li>filter</li> </ul> <pre><code>GET INDEX_NAME/_search\n{\n  \"query\": {\n    \"bool\": {\n      \"must\": [\n        { \"match\": { \"title\": \"apple\" } }\n      ],\n      \"filter\": [\n        { \"range\": { \"price\": { \"lt\": 100 } } }\n      ],\n      \"must_not\": [\n        { \"term\": { \"condition\": \"refurbished\" } }\n      ]\n    }\n  }\n}\n</code></pre> <p>sort</p> <p>For number/date/keyword</p> <pre><code>\"sort\": [\n  { \"price\": \"asc\" }\n]\n</code></pre> <p>size For paging.</p> <pre><code>GET INDEX_NAME/_search\n{\n  \"size\": 10\n}\n</code></pre>"},{"location":"cloud-service/elasticsearch/#cat-api","title":"Cat API","text":""},{"location":"cloud-service/elasticsearch/#index-management-api","title":"Index Management API","text":""}]}